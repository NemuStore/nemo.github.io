# ููุฎุต ุงูุชุญุณููุงุช ุงููููุฐุฉ

## โ ุงูุชุญุณููุงุช ุงูููุฌุฒุฉ

### 1. ุฅุตูุงุญ `getAccessToken`
- โ ุงุณุชุฎุฏุงู Supabase client ุฃููุงู ููุญุตูู ุนูู `access_token`
- โ ุฅุถุงูุฉ timeout (3 ุซูุงูู) ูุชุฌูุจ ุงูุชุนุทู
- โ ุงุณุชุฎุฏุงู `localStorage` ูุจุฏูู
- โ ุฅุฑุฌุงุน `anon key` ููุท ูุญู ุฃุฎูุฑ ูุน ุชุญุฐูุฑ ูุงุถุญ

### 2. ุงูุชุญูู ูู ุงููุตุงุฏูุฉ ูุจู ุนูููุงุช ุฅุฏุฑุงุฌ ุงูุตูุฑ
- โ ุงูุชุญูู ูู ุฃู `access_token` ููุณ `anon key` ูุจู ุฅุฏุฑุงุฌ ุงูุตูุฑ ุงูุนุงูุฉ
- โ ุงูุชุญูู ูู ุฃู `access_token` ููุณ `anon key` ูุจู ุฅุฏุฑุงุฌ ุตูุฑ ุงููุชุบูุฑุงุช
- โ ุฅุธูุงุฑ ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ุนูุฏ ูุดู ุงููุตุงุฏูุฉ
- โ ุชุทุจูู ุงูุชุญูู ูู `addProduct` ู `updateProduct`

### 3. ุงูุชุญูู ูู ุงููุตุงุฏูุฉ ูุจู ุญูุธ ุงููุชุบูุฑุงุช
- โ ุงูุชุญูู ูู ุฃู `access_token` ููุณ `anon key` ูุจู ุญูุธ ุงููุชุบูุฑุงุช ูู `addProduct`
- โ ุงูุชุญูู ูู ุฃู `access_token` ููุณ `anon key` ูุจู ุญูุธ ุงููุชุบูุฑุงุช ูู `updateProduct`
- โ ุฅุธูุงุฑ ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ุนูุฏ ูุดู ุงููุตุงุฏูุฉ

### 4. ุชุญุณูู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก
- โ ุฅุถุงูุฉ ุชุณุฌูู ููุตู ููุฃุฎุทุงุก (status, headers, body)
- โ ุฅุถุงูุฉ ุฑุณุงุฆู ูุงุถุญุฉ ุนูุฏ ุนุฏู ูุฌูุฏ ูุชุบูุฑุงุช
- โ ุฅุถุงูุฉ ุชุญุฐูุฑุงุช ุนูุฏ ุฃุฎุทุงุก ุงููุตุงุฏูุฉ (403, 401)
- โ ุฅุถุงูุฉ `throw new Error` ุนูุฏ ูุดู ุญูุธ ุงููุชุบูุฑุงุช ูุฅููุงู ุงูุนูููุฉ

### 5. ุชุญุณูู ุชุญููู ุงููุชุบูุฑุงุช
- โ ุฅุถุงูุฉ ุฑุณุงูุฉ ูุงุถุญุฉ ุนูุฏ ุนุฏู ูุฌูุฏ ูุชุบูุฑุงุช ููููุชุฌ
- โ ุฅุถุงูุฉ ุชุญุฐูุฑุงุช ุนูุฏ ุฃุฎุทุงุก ุงููุตุงุฏูุฉ ุนูุฏ ุชุญููู ุงููุชุบูุฑุงุช
- โ ุชุณุฌูู ููุตู ูุงุณุชุฌุงุจุฉ API

### 6. ูููุงุช SQL ููุชุญูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- โ `verify_rls_policies.sql` - ููุชุญูู ูู RLS policies
- โ `fix_rls_policies.sql` - ูุฅุตูุงุญ RLS policies
- โ `check_products_and_variants.sql` - ููุชุญูู ูู ุงูููุชุฌุงุช ูุงููุชุบูุฑุงุช
- โ `DATABASE_REVIEW_README.md` - ุชูุซูู ุดุงูู
- โ `HOW_TO_RUN_SQL.md` - ุชุนูููุงุช ุชุดุบูู ูููุงุช SQL

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ ุงููุทููุจุฉ

### 1. ุชุดุบูู ูููุงุช SQL ูู Supabase Dashboard
1. ุงูุชุญ [Supabase Dashboard](https://app.supabase.com)
2. ุงุฎุชุฑ ูุดุฑูุนู
3. ุงุฐูุจ ุฅูู **SQL Editor**
4. ุดุบูู `verify_rls_policies.sql` ููุชุญูู ูู RLS policies
5. ุฅุฐุง ูุงูุช ููุงู ูุดุงููุ ุดุบูู `fix_rls_policies.sql`
6. ุดุบูู `check_products_and_variants.sql` ููุชุญูู ูู ุงูููุชุฌุงุช ูุงููุชุบูุฑุงุช

### 2. ุงูุชุญูู ูู ุฏูุฑ ุงููุณุชุฎุฏู
ุชุฃูุฏ ูู ุฃู ุญุณุงุจู ูุฏูู ุฏูุฑ `admin` ุฃู `manager`:
```sql
SELECT id, email, role, full_name
FROM public.users
WHERE role IN ('admin', 'manager');
```

### 3. ุงุฎุชุจุงุฑ ุญูุธ ุงููุชุบูุฑุงุช
1. ุงูุชุญ `http://localhost:8081` ูู ุงููุชุตูุญ
2. ุณุฌูู ุงูุฏุฎูู ุจุญุณุงุจ ูุฏูู ุฏูุฑ `admin` ุฃู `manager`
3. ุฌุฑุจ ุฅุถุงูุฉ ููุชุฌ ุฌุฏูุฏ ูุน ูุชุบูุฑุงุช
4. ุฑุงุฌุน ุณุฌูุงุช ุงููููุณูู ููุชุฃูุฏ ูู:
   - ุฃู `access_token` ููุฌูุฏ ูุตุงูุญ
   - ุฃู ุงููุชุบูุฑุงุช ุชู ุญูุธูุง ุจูุฌุงุญ
   - ุฃู ุงูุตูุฑ ุชู ุญูุธูุง ุจูุฌุงุญ

## ๐ ุงููุดุงูู ุงููุญุชููุฉ ูุงูุญููู

### ุงููุดููุฉ 1: "ูุดู ุงููุตุงุฏูุฉ. ูุฑุฌู ุชุณุฌูู ุงูุฏุฎูู ูุฑุฉ ุฃุฎุฑู"
**ุงูุณุจุจ:** `access_token` ุบูุฑ ููุฌูุฏ ุฃู ููุชูู ุงูุตูุงุญูุฉ

**ุงูุญู:**
1. ุณุฌูู ุงูุฎุฑูุฌ ุซู ุณุฌูู ุงูุฏุฎูู ูุฑุฉ ุฃุฎุฑู
2. ุชุญูู ูู ุฃู ุญุณุงุจู ูุฏูู ุฏูุฑ `admin` ุฃู `manager`
3. ุฑุงุฌุน ุณุฌูุงุช ุงููููุณูู ููุชุญูู ูู `access_token`

### ุงููุดููุฉ 2: "ูุดู ุญูุธ ุงููุชุบูุฑุงุช: 403 Forbidden"
**ุงูุณุจุจ:** RLS policies ุชุฑูุถ ุงูุฅุฏุฑุงุฌ

**ุงูุญู:**
1. ุดุบูู `fix_rls_policies.sql` ูู Supabase Dashboard
2. ุชุญูู ูู ุฃู ุญุณุงุจู ูุฏูู ุฏูุฑ `admin` ุฃู `manager`
3. ุชุญูู ูู ุฃู `access_token` ููุฌูุฏ ูุตุงูุญ

### ุงููุดููุฉ 3: ุงููุชุบูุฑุงุช ูุง ุชุธูุฑ ุนูุฏ ุงูุชุนุฏูู ุงููุงูู
**ุงูุณุจุจ:** ูุง ุชูุฌุฏ ูุชุบูุฑุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ููุฐุง ุงูููุชุฌ

**ุงูุญู:**
1. ุดุบูู `check_products_and_variants.sql` ููุชุญูู
2. ุฃุถู ูุชุบูุฑุงุช ููููุชุฌ ุจุงุณุชุฎุฏุงู ุงููุงุฌูุฉ
3. ุงุญูุธ ุงูุชุบููุฑุงุช
4. ุฌุฑุจ ุงูุชุนุฏูู ุงููุงูู ูุฑุฉ ุฃุฎุฑู

## ๐ ููุงุญุธุงุช ูููุฉ

- ุฌููุน ุนูููุงุช ุฅุฏุฑุงุฌ ุงูุตูุฑ ูุงููุชุบูุฑุงุช ุงูุขู ุชุชุญูู ูู ูุฌูุฏ `access_token` ุตุงูุญ ูุจู ุงููุญุงููุฉ
- ุฅุฐุง ูุงู `access_token` ุบูุฑ ููุฌูุฏุ ุณูุชู ุฅููุงู ุงูุนูููุฉ ููุฑุงู ูุน ุฑุณุงูุฉ ุฎุทุฃ ูุงุถุญุฉ
- ุฌููุน ุงูุฃุฎุทุงุก ูุชู ุชุณุฌูููุง ุจุดูู ููุตู ูู ุงููููุณูู ูููุณุงุนุฏุฉ ูู ุงูุชุดุฎูุต
- ูููุงุช SQL ูุชููุฑุฉ ููุชุญูู ูู ุญุงูุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุฅุตูุงุญ ุงููุดุงูู

